(function(e){function t(t){for(var a,l,o=t[0],s=t[1],c=t[2],u=0,v=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&v.push(n[l][0]),n[l]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(t);while(v.length)v.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,l=1;l<r.length;l++){var s=r[l];0!==n[s]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={app:0},i=[];function l(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"22edbee5"}[e]+".js"}function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,a){r=n[e]=[t,a]}));t.push(r[2]=a);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=l(e);var c=new Error;i=function(t){s.onerror=s.onload=null,clearTimeout(u);var r=n[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,r[1](c)}n[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/trivy-vulnerability-explorer/",o.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"48b9":function(e,t,r){},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("div",{attrs:{id:"forkongithub"}},[r("a",{attrs:{href:"https://github.com/dbsystel/trivy-vulnerability-explorer",target:"_blank"}},[e._v("Fork me on GitHub")])]),r("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[r("div",{staticClass:"d-flex align-center"},[e._v("Trivy Vulnerability Explorer")]),r("v-spacer")],1),r("v-main",[r("router-view")],1)],1)},i=[],l=a["default"].extend({name:"App",components:{},data:function(){return{}}}),o=l,s=(r("f228"),r("2877")),c=r("6544"),u=r.n(c),d=r("7496"),v=r("40dc"),b=r("f6c4"),f=r("2fa4"),p=Object(s["a"])(o,n,i,!1,null,"0512311d",null),y=p.exports;u()(p,{VApp:d["a"],VAppBar:v["a"],VMain:b["a"],VSpacer:f["a"]});r("d3b7"),r("3ca3"),r("ddb0");var h=r("8c4f"),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-container",{attrs:{fluid:""}},[r("v-row",[r("v-col",[r("v-card",{attrs:{color:"#BBDEFB"}},[r("v-card-title",{staticClass:"headline"},[e._v(" Instructions")]),r("v-card-subtitle",[e._v(" Select a JSON Report from "),r("a",{attrs:{href:"https://github.com/aquasecurity/trivy",target:"_blank"}},[e._v("Trivy")]),e._v(" from your local file system. You may limit the displayed vulnerabilities to a single target. If you need, select the Vulnerabilities that you want to ignore/accept and use the .trivyignore output below for further processing in your pipeline. The data never leaves your browser, promised! ")])],1)],1)],1),r("DataInput",{on:{inputChanged:e.reactivelySetNewVulnerabilities}}),r("DataTable",{attrs:{selectedVulnerabilities:e.selectedVulnerabilities}})],1)],1)},g=[],O=r("2909"),j=r("d4ec"),V=r("bee2"),x=r("257e"),w=r("262e"),_=r("2caf"),T=r("ade3"),S=(r("99af"),r("a434"),r("159b"),r("9ab4")),k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",{attrs:{md:"3",sm:"12"}},[r("VueFileAgent",{staticClass:"upload-block",attrs:{multiple:!1,deletable:!1,theme:"list",accept:"application/json",errorText:{size:"This file is too large to be attached"}},on:{select:e.onFileChange},scopedSlots:e._u([{key:"file-preview",fn:function(t){return[r("div",{key:t.index,staticClass:"grid-box-item file-row"},[r("button",{staticClass:"close remove",attrs:{type:"button","aria-label":"Remove"},on:{click:function(r){return e.removeFileRecord(t.fileRecord)}}},[r("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])]),r("strong",[e._v(e._s(t.fileRecord.name()))]),r("span",{staticClass:"text-muted"},[e._v("("+e._s(t.fileRecord.size())+")")])])]}},{key:"file-preview-new",fn:function(){return[r("div",{key:"new",staticClass:"text-left my-3"})]},proxy:!0}])})],1),r("v-col",[r("v-autocomplete",{attrs:{clearable:"",items:e.vulnerabilityReport,"item-text":"Target","item-value":"Target",outlined:"",label:"Select Target"},model:{value:e.selectedTarget,callback:function(t){e.selectedTarget=t},expression:"selectedTarget"}})],1)],1)},C=[],R=(r("7db0"),r("5db7"),r("73d9"),r("4de4"),r("7924")),I=r.n(R),F=r("1b40");a["default"].use(I.a);var E=function(e){Object(w["a"])(r,e);var t=Object(_["a"])(r);function r(){var e;Object(j["a"])(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(T["a"])(Object(x["a"])(e),"selectedTarget",""),Object(T["a"])(Object(x["a"])(e),"file",{}),Object(T["a"])(Object(x["a"])(e),"vulnerabilityReport",[{Target:"test",Type:"type"}]),e}return Object(V["a"])(r,[{key:"selectedVulnerabilities",get:function(){var e,t=this;return this.selectedTarget?null===(e=this.vulnerabilityReport.find((function(e){return e.Target===t.selectedTarget})))||void 0===e?void 0:e.Vulnerabilities:this.vulnerabilityReport.filter((function(e){return e.Vulnerabilities})).flatMap((function(e){return e.Vulnerabilities}))}},{key:"onNewTarget",value:function(){this.$emit("inputChanged",this.selectedVulnerabilities)}},{key:"parseFile",value:function(e){var t,r;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.result&&"string"===typeof e.target.result){var a=JSON.parse(e.target.result);r=a.SchemaVersion&&a.SchemaVersion>=2?a.Results:a,r.forEach((function(e){var t;return null===(t=e.Vulnerabilities)||void 0===t?void 0:t.forEach((function(t){return t.Target=e.Target}))}))}return r}},{key:"onFileChange",value:function(e){var t=this,r=e[0],a=new FileReader;a.onload=function(e){var r,a=t.parseFile(e);a&&(t.vulnerabilityReport.splice(0),(r=t.vulnerabilityReport).push.apply(r,Object(O["a"])(a)),t.onNewTarget())},a.readAsText(r.file)}}]),r}(a["default"]);Object(S["a"])([Object(F["c"])("selectedTarget")],E.prototype,"onNewTarget",null),Object(S["a"])([Object(F["c"])("file")],E.prototype,"onFileChange",null),E=Object(S["a"])([F["a"]],E);var A=E,D=A,N=(r("f5a5"),r("c6a6")),P=r("62ad"),B=r("0fd9"),M=Object(s["a"])(D,k,C,!1,null,"f8fe0956",null),L=M.exports;u()(M,{VAutocomplete:N["a"],VCol:P["a"],VRow:B["a"]});var $=function(){var e=this,t=this,r=t.$createElement,a=t._self._c||r;return a("span",[a("v-text-field",{staticClass:"mb-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"",outlined:"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),a("v-tabs",{attrs:{dark:"","background-color":"primary",grow:"","hide-slider":"","show-arrows":""}},[a("v-tab",{on:{click:function(e){t.search=""}}},[t._v("Total: "+t._s(t.vulnerabilityStats.total)+" ")]),a("v-tab",{on:{click:function(e){t.search=""}}},[t._v("Fixable: "+t._s(t.vulnerabilityStats.fixable))]),t._l(t.vulnerabilityStats.severityInformation,(function(e){return a("v-tab",{key:e.severity,on:{click:function(r){t.search=e.severity}}},[t._v(" "+t._s(e.severity)+": "+t._s(e.count)+" ")])}))],2),a("v-data-table",{staticClass:"elevation-1 mb-10",attrs:{dense:"","show-select":"",headers:t.headers,"items-per-page":20,items:t.selectedVulnerabilities,"item-key":"id","show-expand":"","single-expand":"","sort-by":t.sortBy,search:t.search,expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var r=e.headers,n=e.item;return[a("td",{attrs:{colspan:r.length}},[a("h3",[t._v(t._s(n.Title))]),a("p",[t._v(t._s(n.Description))]),a("p",[a("a",{attrs:{href:n.PrimaryURL}},[t._v(t._s(n.PrimaryURL))])])])]}}]),model:{value:t.ignoredVulnerabilities,callback:function(e){t.ignoredVulnerabilities=e},expression:"ignoredVulnerabilities"}}),a("v-btn",{directives:[{name:"clipboard",rawName:"v-clipboard",value:function(){return e.ignoredCves},expression:"() => this.ignoredCves"}],staticClass:"mb-5",attrs:{color:"primary"}},[t._v(" Copy .trivyignore to Clipboard ")]),a("v-textarea",{attrs:{outlined:"",label:".trivyignore",value:t.ignoredCves,readonly:""}})],1)},H=[],J=(r("d81d"),r("a630"),r("6062"),r("4e827"),r("a15b"),r("4ae6")),U=r.n(J);a["default"].use(U.a);var q=function(e){Object(w["a"])(r,e);var t=Object(_["a"])(r);function r(){var e;Object(j["a"])(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(T["a"])(Object(x["a"])(e),"selectedVulnerabilities",void 0),Object(T["a"])(Object(x["a"])(e),"ignoredVulnerabilities",[]),Object(T["a"])(Object(x["a"])(e),"expanded",[]),Object(T["a"])(Object(x["a"])(e),"sortBy","Severity"),Object(T["a"])(Object(x["a"])(e),"search",""),Object(T["a"])(Object(x["a"])(e),"severitySortOrder",{CRITICAL:0,HIGH:1,MEDIUM:2,LOW:3,UNKNOWN:4}),Object(T["a"])(Object(x["a"])(e),"headers",[{text:"Target",value:"Target"},{text:"PkgName",value:"PkgName"},{text:"VulnerabilityID",value:"VulnerabilityID"},{value:"Severity",text:"Severity",sort:e.compareBySeverity},{text:"InstalledVersion",value:"InstalledVersion"},{text:"FixedVersion",value:"FixedVersion"}]),e}return Object(V["a"])(r,[{key:"ignoredCves",get:function(){var e=this,t=Array.from(new Set(this.ignoredVulnerabilities.map((function(e){return e.VulnerabilityID})))).map((function(t){return e.ignoredVulnerabilities.find((function(e){return e.VulnerabilityID===t}))})),r=[];return t.sort((function(t,r){return e.compareBySeverity(t.Severity,r.Severity)})),null===t||void 0===t||t.forEach((function(e){r.push("# ".concat(e.Severity,": ").concat(e.Title)),r.push(e.VulnerabilityID)})),r.join("\n")}},{key:"vulnerabilityStats",get:function(){var e=this,t=this.selectedVulnerabilities.length,r=this.selectedVulnerabilities.filter((function(e){return void 0!=e.FixedVersion})).length,a=Object(O["a"])(new Set(this.selectedVulnerabilities.map((function(e){return e.Severity})))),n=a.map((function(t){return{severity:t,count:e.selectedVulnerabilities.filter((function(e){return e.Severity===t})).length}})).sort((function(t,r){return e.compareBySeverity(t.severity,r.severity)}));return{total:t,fixable:r,severityInformation:n}}},{key:"compareBySeverity",value:function(e,t){return this.severitySortOrder[e]-this.severitySortOrder[t]}}]),r}(a["default"]);Object(S["a"])([Object(F["b"])({required:!0})],q.prototype,"selectedVulnerabilities",void 0),q=Object(S["a"])([F["a"]],q);var z=q,G=z,W=r("8336"),K=r("8fea"),Y=r("71a3"),Q=r("fe57"),X=r("8654"),Z=r("a844"),ee=Object(s["a"])(G,$,H,!1,null,"32ac5ae2",null),te=ee.exports;u()(ee,{VBtn:W["a"],VDataTable:K["a"],VTab:Y["a"],VTabs:Q["a"],VTextField:X["a"],VTextarea:Z["a"]});var re=function(e){Object(w["a"])(r,e);var t=Object(_["a"])(r);function r(){var e;Object(j["a"])(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(T["a"])(Object(x["a"])(e),"selectedVulnerabilities",[]),e}return Object(V["a"])(r,[{key:"reactivelySetNewVulnerabilities",value:function(e){var t;this.selectedVulnerabilities.splice(0),e.forEach((function(e,t){return e.id=t})),(t=this.selectedVulnerabilities).push.apply(t,Object(O["a"])(e))}}]),r}(a["default"]);re=Object(S["a"])([Object(F["a"])({components:{DataTable:te,DataInput:L}})],re);var ae=re,ne=ae,ie=r("b0af"),le=r("99d9"),oe=r("a523"),se=Object(s["a"])(ne,m,g,!1,null,null,null),ce=se.exports;u()(se,{VCard:ie["a"],VCardSubtitle:le["a"],VCardTitle:le["b"],VCol:P["a"],VContainer:oe["a"],VRow:B["a"]}),a["default"].use(h["a"]);var ue=[{path:"/",name:"Home",component:ce},{path:"/about",name:"About",component:function(){return r.e("about").then(r.bind(null,"f820"))}}],de=new h["a"]({mode:"history",base:"/trivy-vulnerability-explorer/",routes:ue}),ve=de,be=r("f309");a["default"].use(be["a"]);var fe=new be["a"]({});a["default"].config.productionTip=!1,new a["default"]({router:ve,data:{vulnerabilities:void 0},vuetify:fe,render:function(e){return e(y)}}).$mount("#app")},f228:function(e,t,r){"use strict";r("f944")},f5a5:function(e,t,r){"use strict";r("48b9")},f944:function(e,t,r){}});
//# sourceMappingURL=app.d979fc2e.js.map